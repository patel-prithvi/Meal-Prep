<style>
/* ========== NAVBAR THEME ========== */
.navbar {
  background: var(--card);
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
  transition: background 0.4s ease;
}

.navbar-brand {
  font-weight: 700;
  color: var(--text) !important;
}

.nav-link {
  color: var(--text) !important;
  font-weight: 500;
  position: relative;
  transition: color 0.3s ease;
}

.nav-link:hover {
  color: var(--primary) !important;
}

.nav-link.active::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: -6px;
  width: 100%;
  height: 2px;
  background: var(--primary);
}

/* Dark mode brand fix */
body.dark .navbar-brand {
  color: #ffffff !important;
}

body.dark .navbar {
  background: #020617 !important;
  border-bottom: 1px solid #1e293b;
}

/* Toggle button */
#themeToggle {
  transition: transform 0.3s ease;
}
#themeToggle:hover {
  transform: rotate(15deg);
}
</style>

<nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
    <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="/dashboard">
      <img src="/static/images/logo.png" height="28">
      <span>Meal Planner</span>
    </a>
    
    <ul class="navbar-nav ms-auto align-items-center gap-3">
      <li>
        <a class="nav-link {% if request.path == '/dashboard' %}active{% endif %}"
           href="/dashboard">
          Home
        </a>
      </li>

      <li>
        <a class="nav-link {% if request.path == '/mealplan' %}active{% endif %}"
           href="/mealplan">
          Your Plan
        </a>
      </li>

      <li>
        <a class="nav-link" href="/blog">Blog</a>
      </li>

      <li>
        <a class="nav-link" href="/profile">Profile</a>
      </li>
      
      <li>
        <button id="themeToggle"
                class="btn btn-sm btn-outline-secondary"
                onclick="toggleDark()">üåô</button>
      </li>

      <li>
        <a href="/logout"
          onclick="return confirm('Are you sure you want to logout?')"
          class="btn btn-outline-danger btn-sm px-3">
          Logout
        </a>
      </li>
    </ul>
  </div>
</nav>

<script>

  function toggleDark() {
    const body = document.body;
    const btn = document.getElementById("themeToggle");
    body.classList.toggle("dark");
    const isDark = body.classList.contains("dark");
    // SAVE preference
    localStorage.setItem("theme", isDark ? "dark" : "light");

    // Update icon
    btn.innerText = isDark ? "‚òÄÔ∏è" : "üåô";
  }

  (function applySavedTheme() {
    const savedTheme = localStorage.getItem("theme");
    const body = document.body;
    const btn = document.getElementById("themeToggle");

    if (savedTheme === "dark") {
      body.classList.add("dark");
      if (btn) btn.innerText = "‚òÄÔ∏è";
    } else {
      body.classList.remove("dark");
      if (btn) btn.innerText = "üåô";
    }
  })();
  
</script>